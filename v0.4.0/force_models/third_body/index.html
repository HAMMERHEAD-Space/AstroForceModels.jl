<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Third Body Gravity ¬∑ AstroForceModels.jl</title><meta name="title" content="Third Body Gravity ¬∑ AstroForceModels.jl"/><meta property="og:title" content="Third Body Gravity ¬∑ AstroForceModels.jl"/><meta property="twitter:title" content="Third Body Gravity ¬∑ AstroForceModels.jl"/><meta name="description" content="Documentation for AstroForceModels.jl."/><meta property="og:description" content="Documentation for AstroForceModels.jl."/><meta property="twitter:description" content="Documentation for AstroForceModels.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="AstroForceModels.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">AstroForceModels.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../man/usage/">Usage</a></li><li><span class="tocitem">Force Models</span><ul><li><a class="tocitem" href="../gravity/">Gravity / Zonal Harmonics</a></li><li><a class="tocitem" href="../drag/">Drag</a></li><li><a class="tocitem" href="../solar_radiation_pressure/">Solar Radiation Pressure</a></li><li class="is-active"><a class="tocitem" href>Third Body Gravity</a><ul class="internal"><li><a class="tocitem" href="#Physical-Description"><span>Physical Description</span></a></li><li><a class="tocitem" href="#Key-Third-Bodies"><span>Key Third Bodies</span></a></li><li><a class="tocitem" href="#Components"><span>Components</span></a></li><li><a class="tocitem" href="#Usage-Example"><span>Usage Example</span></a></li><li><a class="tocitem" href="#Implementation-Details"><span>Implementation Details</span></a></li><li><a class="tocitem" href="#Magnitude-of-Effects"><span>Magnitude of Effects</span></a></li><li><a class="tocitem" href="#References"><span>References</span></a></li></ul></li><li><a class="tocitem" href="../relativity/">Relativistic Effects</a></li></ul></li><li><a class="tocitem" href="../../man/api/">API Reference</a></li><li><a class="tocitem" href="../../lib/library/">Library</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Force Models</a></li><li class="is-active"><a href>Third Body Gravity</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Third Body Gravity</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/HAMMERHEAD-Space/AstroForceModels.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands">ÔÇõ</span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/HAMMERHEAD-Space/AstroForceModels.jl/blob/master/docs/src/force_models/third_body.md" title="Edit source on GitHub"><span class="docs-icon fa-solid">ÔÅÑ</span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Third-Body-Gravity"><a class="docs-heading-anchor" href="#Third-Body-Gravity">Third Body Gravity</a><a id="Third-Body-Gravity-1"></a><a class="docs-heading-anchor-permalink" href="#Third-Body-Gravity" title="Permalink"></a></h1><p>Third body gravity accounts for the gravitational perturbations on a spacecraft caused by celestial bodies other than the primary body (typically Earth). The most significant third bodies are the Sun and Moon, but other planets can also contribute to orbital perturbations, especially for high-altitude satellites or interplanetary missions.</p><h2 id="Physical-Description"><a class="docs-heading-anchor" href="#Physical-Description">Physical Description</a><a id="Physical-Description-1"></a><a class="docs-heading-anchor-permalink" href="#Physical-Description" title="Permalink"></a></h2><p>In the two-body problem, only the gravitational attraction between the spacecraft and the primary body (Earth) is considered. However, real spacecraft are also influenced by the gravitational fields of other massive bodies in the solar system. These third body perturbations become increasingly important as the spacecraft&#39;s distance from Earth increases.</p><p>The third body acceleration is given by:</p><pre><code class="nohighlight hljs">a_third = Œº_third * [(r_third - r_sat)/|r_third - r_sat|¬≥ - r_third/|r_third|¬≥]</code></pre><p>Where:</p><ul><li><code>Œº_third</code> is the gravitational parameter of the third body</li><li><code>r_third</code> is the position vector of the third body relative to Earth&#39;s center</li><li><code>r_sat</code> is the position vector of the spacecraft relative to Earth&#39;s center</li><li>The first term represents direct attraction to the third body</li><li>The second term represents the differential effect (Earth&#39;s acceleration toward the third body)</li></ul><h2 id="Key-Third-Bodies"><a class="docs-heading-anchor" href="#Key-Third-Bodies">Key Third Bodies</a><a id="Key-Third-Bodies-1"></a><a class="docs-heading-anchor-permalink" href="#Key-Third-Bodies" title="Permalink"></a></h2><h3 id="Sun"><a class="docs-heading-anchor" href="#Sun">Sun</a><a id="Sun-1"></a><a class="docs-heading-anchor-permalink" href="#Sun" title="Permalink"></a></h3><ul><li><strong>Gravitational parameter</strong>: Œº‚òâ = 1.327√ó10¬π¬π km¬≥/s¬≤</li><li><strong>Distance from Earth</strong>: ~1 AU (varies ¬±3.4% due to eccentricity)</li><li><strong>Primary effects</strong>: Long-period orbital variations, secular drift</li><li><strong>Most significant for</strong>: High-altitude and interplanetary missions</li></ul><h3 id="Moon"><a class="docs-heading-anchor" href="#Moon">Moon</a><a id="Moon-1"></a><a class="docs-heading-anchor-permalink" href="#Moon" title="Permalink"></a></h3><ul><li><strong>Gravitational parameter</strong>: Œºüåô = 4.903√ó10¬≥ km¬≥/s¬≤</li><li><strong>Distance from Earth</strong>: ~384,400 km (varies ¬±11% due to eccentricity)</li><li><strong>Primary effects</strong>: Short-period oscillations, resonance phenomena</li><li><strong>Most significant for</strong>: High Earth orbits, lunar missions</li></ul><h3 id="Other-Planets"><a class="docs-heading-anchor" href="#Other-Planets">Other Planets</a><a id="Other-Planets-1"></a><a class="docs-heading-anchor-permalink" href="#Other-Planets" title="Permalink"></a></h3><p>For specialized missions, other planets may be significant:</p><ul><li><strong>Jupiter</strong>: Œº‚ôÉ = 1.267√ó10‚Å∏ km¬≥/s¬≤ (interplanetary missions)</li><li><strong>Venus</strong>: Œº‚ôÄ = 3.249√ó10‚Åµ km¬≥/s¬≤ (inner solar system missions)</li><li><strong>Mars</strong>: Œº‚ôÇ = 4.283√ó10‚Å¥ km¬≥/s¬≤ (Mars missions and transfers)</li></ul><h2 id="Components"><a class="docs-heading-anchor" href="#Components">Components</a><a id="Components-1"></a><a class="docs-heading-anchor-permalink" href="#Components" title="Permalink"></a></h2><p>The third body force model in AstroForceModels includes:</p><h3 id="ThirdBodyAstroModel"><a class="docs-heading-anchor" href="#ThirdBodyAstroModel">ThirdBodyAstroModel</a><a id="ThirdBodyAstroModel-1"></a><a class="docs-heading-anchor-permalink" href="#ThirdBodyAstroModel" title="Permalink"></a></h3><p>The main struct for third body computations:</p><ul><li><strong>third<em>body</em>model</strong>: Contains celestial body properties and ephemeris data</li><li><strong>eop_data</strong>: Earth orientation parameters for coordinate transformations</li></ul><h3 id="ThirdBodyModel"><a class="docs-heading-anchor" href="#ThirdBodyModel">ThirdBodyModel</a><a id="ThirdBodyModel-1"></a><a class="docs-heading-anchor-permalink" href="#ThirdBodyModel" title="Permalink"></a></h3><p>Contains information about specific celestial bodies:</p><ul><li><strong>body</strong>: Celestial body identifier (SUN, MOON, etc.)</li><li><strong>ephemeris_type</strong>: Method for computing body position (:analytical, :de430, etc.)</li><li><strong>gravitational_parameter</strong>: Œº value for the celestial body</li></ul><h3 id="CelestialBody"><a class="docs-heading-anchor" href="#CelestialBody">CelestialBody</a><a id="CelestialBody-1"></a><a class="docs-heading-anchor-permalink" href="#CelestialBody" title="Permalink"></a></h3><p>Defines properties of celestial bodies:</p><ul><li><strong>name</strong>: Body identifier  </li><li><strong>Œº</strong>: Gravitational parameter</li><li><strong>radius</strong>: Physical radius</li><li><strong>ephemeris_data</strong>: Orbital elements or ephemeris coefficients</li></ul><h2 id="Usage-Example"><a class="docs-heading-anchor" href="#Usage-Example">Usage Example</a><a id="Usage-Example-1"></a><a class="docs-heading-anchor-permalink" href="#Usage-Example" title="Permalink"></a></h2><pre><code class="language-julia hljs">using AstroForceModels
using SatelliteToolboxCelestialBodies
using SatelliteToolboxBase

# Load Earth orientation parameters
eop_data = fetch_iers_eop()

# Create Sun model
sun_model = ThirdBodyModel(; body=SunBody(), eop_data=eop_data)
# Create Moon model  
moon_model = ThirdBodyModel(; body=MoonBody(), eop_data=eop_data)

# Create third body models
sun_perturbation = ThirdBodyAstroModel(
    third_body_model = sun_model,
    eop_data = eop_data
)

moon_perturbation = ThirdBodyAstroModel(
    third_body_model = moon_model, 
    eop_data = eop_data
)

# These can be combined with other force models
acceleration(state, parameters, time, sun_perturbation)
acceleration(state, parameters, time, moon_perturbation)</code></pre><h2 id="Implementation-Details"><a class="docs-heading-anchor" href="#Implementation-Details">Implementation Details</a><a id="Implementation-Details-1"></a><a class="docs-heading-anchor-permalink" href="#Implementation-Details" title="Permalink"></a></h2><p>Third body acceleration computation involves:</p><ol><li><strong>Ephemeris Calculation</strong>: Computing third body position at current time</li><li><strong>Coordinate Transformation</strong>: Converting to appropriate reference frame</li><li><strong>Distance Calculation</strong>: Computing distances from spacecraft and Earth to third body</li><li><strong>Differential Acceleration</strong>: Computing the difference in gravitational acceleration</li><li><strong>Vector Operations</strong>: Determining acceleration direction and magnitude</li></ol><h2 id="Magnitude-of-Effects"><a class="docs-heading-anchor" href="#Magnitude-of-Effects">Magnitude of Effects</a><a id="Magnitude-of-Effects-1"></a><a class="docs-heading-anchor-permalink" href="#Magnitude-of-Effects" title="Permalink"></a></h2><p>Third body perturbations vary significantly with orbital characteristics:</p><h3 id="Low-Earth-Orbit-(LEO,-400-km)"><a class="docs-heading-anchor" href="#Low-Earth-Orbit-(LEO,-400-km)">Low Earth Orbit (LEO, ~400 km)</a><a id="Low-Earth-Orbit-(LEO,-400-km)-1"></a><a class="docs-heading-anchor-permalink" href="#Low-Earth-Orbit-(LEO,-400-km)" title="Permalink"></a></h3><ul><li><strong>Sun</strong>: ~10‚Åª‚Åπ m/s¬≤ (negligible)</li><li><strong>Moon</strong>: ~10‚Åª‚Åπ m/s¬≤ (negligible)</li><li><strong>Dominates</strong>: Atmospheric drag, Earth oblateness</li></ul><h3 id="Medium-Earth-Orbit-(MEO,-20,000-km)"><a class="docs-heading-anchor" href="#Medium-Earth-Orbit-(MEO,-20,000-km)">Medium Earth Orbit (MEO, ~20,000 km)</a><a id="Medium-Earth-Orbit-(MEO,-20,000-km)-1"></a><a class="docs-heading-anchor-permalink" href="#Medium-Earth-Orbit-(MEO,-20,000-km)" title="Permalink"></a></h3><ul><li><strong>Sun</strong>: ~10‚Åª‚Å∑ m/s¬≤ (significant)</li><li><strong>Moon</strong>: ~10‚Åª‚Å∂ m/s¬≤ (very significant)</li><li><strong>Applications</strong>: GPS constellation, navigation satellites</li></ul><h3 id="Geostationary-Orbit-(GEO,-35,786-km)"><a class="docs-heading-anchor" href="#Geostationary-Orbit-(GEO,-35,786-km)">Geostationary Orbit (GEO, ~35,786 km)</a><a id="Geostationary-Orbit-(GEO,-35,786-km)-1"></a><a class="docs-heading-anchor-permalink" href="#Geostationary-Orbit-(GEO,-35,786-km)" title="Permalink"></a></h3><ul><li><strong>Sun</strong>: ~10‚Åª‚Å∂ m/s¬≤ (very significant)  </li><li><strong>Moon</strong>: ~10‚Åª‚Å∂ m/s¬≤ (very significant)</li><li><strong>Effects</strong>: Station-keeping requirements, orbital drift</li></ul><h3 id="High-Earth-Orbit-(HEO,-35,786-km)"><a class="docs-heading-anchor" href="#High-Earth-Orbit-(HEO,-35,786-km)">High Earth Orbit (HEO, &gt;35,786 km)</a><a id="High-Earth-Orbit-(HEO,-35,786-km)-1"></a><a class="docs-heading-anchor-permalink" href="#High-Earth-Orbit-(HEO,-35,786-km)" title="Permalink"></a></h3><ul><li><strong>Sun</strong>: ~10‚Åª‚Å∂ to 10‚Åª‚Åµ m/s¬≤ (dominant perturbation)</li><li><strong>Moon</strong>: ~10‚Åª‚Å∂ to 10‚Åª‚Åµ m/s¬≤ (dominant perturbation)</li><li><strong>Applications</strong>: Scientific missions, space telescopes</li></ul><h2 id="References"><a class="docs-heading-anchor" href="#References">References</a><a id="References-1"></a><a class="docs-heading-anchor-permalink" href="#References" title="Permalink"></a></h2><p>[1] Vallado, David A. &quot;Fundamentals of Astrodynamics and Applications.&quot; 4th ed., 2013. [2] Montenbruck, Oliver, and Eberhard Gill. &quot;Satellite Orbits: Models, Methods and Applications.&quot; Springer, 2000. [3] Battin, Richard H. &quot;An Introduction to the Mathematics and Methods of Astrodynamics.&quot; AIAA, 1999. [4] Kaplan, Marshall H. &quot;Modern Spacecraft Dynamics and Control.&quot; Wiley, 1976. [5] Cappellari, J. O., et al. &quot;Mathematical Theory of the Goddard Trajectory Determination System.&quot; NASA, 1976. </p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../solar_radiation_pressure/">¬´ Solar Radiation Pressure</a><a class="docs-footer-nextpage" href="../relativity/">Relativistic Effects ¬ª</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Sunday 15 February 2026 01:29">Sunday 15 February 2026</span>. Using Julia version 1.11.9.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
